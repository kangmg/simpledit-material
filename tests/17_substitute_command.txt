# Test Substitute Command
cls

# 1. Test sub atom
add mol xyz <<WTR
3

C 0.000000 0.000000  0.000000
H 0.758602 0.000000  0.504284
H 0.260455 0.000000 -0.872893
WTR
rebond
time 2

select :
sub atom 0 O
time 2

# 2. Test sub grp (Explicit)
# Create Target Mol
new TargetMol
add atom C 0 0 0
add atom H 1.5 0 0
add bond 0 1 
time 2

# Create Source Mol
new SourceMol
add atom N 0 0 0
add atom H 1.5 0 0
add bond 0 1
time 2

# Switch to Target
switch TargetMol

# Substitute: Target(0) replaced by Source(0) attached at Source(1)
# Target: Leaving=1(H), Anchor=0(C)
# Source: Leaving=1(H), Anchor=0(N)
sub grp 1 0 -n SourceMol 1 0
# Result: C-N bond.

# 3. Test sub grp (Implicit Dummy)
# Create Target with Dummy X
new TargetDummy
add atom C 0 0 0
add atom X 1.5 0 0
add bond 0 1
time 2

# Create Source with Dummy X
new SourceDummy
add atom N 0 0 0
add atom X 1.5 0 0
add bond 0 1
time 2

switch TargetDummy
# Substitute: Anchor=0(C), Implicit Leaving=1(X)
# Source: Anchor=0(N), Implicit Leaving=1(X)
sub grp 0 -n SourceDummy 0
# Result: C-N bond, X atoms removed.
time 2

del atoms : 